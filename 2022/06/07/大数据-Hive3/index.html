<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>大数据-Hive3.x | 傻瓜の博客</title><meta name="keywords" content="Hive"><meta name="author" content="Kirito,541039648@qq.com"><meta name="copyright" content="Kirito"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Hive">
<meta property="og:type" content="article">
<meta property="og:title" content="大数据-Hive3.x">
<meta property="og:url" content="https://dgut-zzf.github.io/2022/06/07/%E5%A4%A7%E6%95%B0%E6%8D%AE-Hive3/index.html">
<meta property="og:site_name" content="傻瓜の博客">
<meta property="og:description" content="Hive">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dgut-zzf.github.io/img/avatar/%E8%9D%B6%E7%A5%882.gif">
<meta property="article:published_time" content="2022-06-07T12:43:08.000Z">
<meta property="article:modified_time" content="2022-07-10T03:52:38.399Z">
<meta property="article:author" content="Kirito">
<meta property="article:tag" content="Hive">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dgut-zzf.github.io/img/avatar/%E8%9D%B6%E7%A5%882.gif"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://dgut-zzf.github.io/2022/06/07/%E5%A4%A7%E6%95%B0%E6%8D%AE-Hive3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?07f5446655e9ab8c8f43c3f215d27a1b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-2MDKV7YRZQ"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-2MDKV7YRZQ');
</script><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "89wndti20j");</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":30},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Kirito","link":"链接: ","source":"来源: 傻瓜の博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '大数据-Hive3.x',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-10 11:52:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    document.addEventListener('pjax:complete', detectApple)})(window)</script><link rel="stylesheet" href="/css/prettify.css"><script src="/js/prettify.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar/%E8%9D%B6%E7%A5%882.gif" onerror="onerror=null;src='/img/background/蝶祈2.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">39</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">傻瓜の博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">大数据-Hive3.x</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-06-07T12:43:08.000Z" title="发表于 2022-06-07 20:43:08">2022-06-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-10T03:52:38.399Z" title="更新于 2022-07-10 11:52:38">2022-07-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Hive/">Hive</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>20分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="大数据-Hive3.x"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><h1 id="第-1-章-Hive-基本概念"><a href="#第-1-章-Hive-基本概念" class="headerlink" title="第 1 章 Hive 基本概念"></a>第 1 章 Hive 基本概念</h1><h2 id="什么是-Hive"><a href="#什么是-Hive" class="headerlink" title="什么是 Hive"></a>什么是 Hive</h2><ol>
<li> hive 简介<br>Hive：由 Facebook 开源用于解决海量<code>结构化</code>日志的数据统计工具。<br>Hive 是基于 Hadoop 的一个<code>数据仓库工具</code>，可以将<code>结构化的数据文件映射为一张表</code>，提供<code>类 SQL</code> 查询功能.</li>
<li>Hive 本质<br>将 HQL 转化成 <code>MapReduce</code> 程序<br><img src="/img/Hive/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20211109105855.png"></li>
</ol>
<ul>
<li>Hive 处理的数据存储在 <code>HDFS</code></li>
<li>Hive 分析数据底层的实现是 <code>MapReduce</code></li>
<li>执行程序运行在 <code>Yarn</code> 上</li>
</ul>
<h2 id="Hive-的优缺点"><a href="#Hive-的优缺点" class="headerlink" title="Hive 的优缺点"></a>Hive 的优缺点</h2><ol>
<li>优点</li>
</ol>
<ul>
<li>操作接口采用类 SQL 语法，提供快速开发的能力（简单、容易上手）。</li>
<li>避免了去写 MapReduce，减少开发人员的学习成本。</li>
<li>Hive 的执行延迟比较高，因此 Hive 常用于数据分析，对实时性要求不高的场合。</li>
<li>Hive 优势在于处理大数据，对于处理小数据没有优势，因为 Hive 的执行延迟比较高。</li>
<li>Hive 支持用户自定义函数，用户可以根据自己的需求来实现自己的函数。</li>
</ul>
<ol start="2">
<li>缺点</li>
</ol>
<ul>
<li>Hive 的 HQL 表达能力有限<br>（1）迭代式算法无法表达<br>（2）数据挖掘方面不擅长，由于 MapReduce 数据处理流程的限制，效率更高的算法却无法实现。</li>
<li>Hive 的效率比较低<br>（1）Hive 自动生成的 MapReduce 作业，通常情况下不够智能化<br>（2）Hive 调优比较困难，粒度较粗</li>
</ul>
<h2 id="Hive-架构原理"><a href="#Hive-架构原理" class="headerlink" title="Hive 架构原理"></a>Hive 架构原理</h2><p><img src="/img/Hive/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20211109154724.png"></p>
<ol>
<li>用户接口：Client<br>CLI（command-line interface）、JDBC/ODBC(jdbc 访问 hive)、WEBUI（浏览器访问 hive）</li>
<li>元数据：Metastore<br>元数据包括：表名、表所属的数据库（默认是 default）、表的拥有者、列/分区字段、表的类型（是否是外部表）、表的数据所在目录等；<br><code>默认存储在自带的 derby 数据库中，推荐使用 MySQL 存储 Metastore</code></li>
<li>Hadoop<br>使用 HDFS 进行存储，使用 MapReduce 进行计算。</li>
<li>驱动器：Driver</li>
</ol>
<ul>
<li>解析器（SQL Parser）：将 SQL 字符串转换成抽象语法树 AST，这一步一般都用第<br>三方工具库完成，比如 antlr；对 AST 进行语法分析，比如表是否存在、字段是否存在、SQL<br>语义是否有误。</li>
<li>编译器（Physical Plan）：将 AST 编译生成逻辑执行计划。</li>
<li>优化器（Query Optimizer）：对逻辑执行计划进行优化。</li>
<li>执行器（Execution）：把逻辑执行计划转换成可以运行的物理计划。对于 Hive 来说，就是 MR/Spark。<br><img src="/img/Hive/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20211109155818.png"><br>Hive 通过给用户提供的一系列交互接口，接收到用户的指令(SQL)，使用自己的 Driver，结合元数据(MetaStore)，将这些指令翻译成 MapReduce，提交到 Hadoop 中执行，最后，将执行返回的结果输出到用户交互接口。</li>
</ul>
<h2 id="Hive-和数据库比较"><a href="#Hive-和数据库比较" class="headerlink" title="Hive 和数据库比较"></a>Hive 和数据库比较</h2><p>由于 Hive 采用了类似 SQL 的查询语言 HQL(Hive Query Language)，因此很容易将 Hive 理解为数据库。其实从结构上来看，Hive 和数据库除了拥有类似的查询语言，再无类似之处。<br>本文将从多个方面来阐述 Hive 和数据库的差异。数据库可以用在 Online 的应用中，但是Hive 是为数据仓库而设计的，清楚这一点，有助于从应用角度理解 Hive 的特性。</p>
<h3 id="查询语言"><a href="#查询语言" class="headerlink" title="查询语言"></a>查询语言</h3><p>由于 SQL 被广泛的应用在数据仓库中，因此，专门针对 Hive 的特性设计了类 SQL 的查询语言 HQL。熟悉 SQL 开发的开发者可以很方便的使用 Hive 进行开发。</p>
<h3 id="数据更新"><a href="#数据更新" class="headerlink" title="数据更新"></a>数据更新</h3><p>由于 Hive 是针对数据仓库应用设计的，而<code>数据仓库的内容是读多写少的</code>。因此，<code>Hive 中不建议对数据的改写，所有的数据都是在加载的时候确定好的</code>。而数据库中的数据通常是需要经常进行修改的，因此可以使用 INSERT INTO … VALUES 添加数据，使用 UPDATE … SET 修改数据。</p>
<h3 id="执行延迟"><a href="#执行延迟" class="headerlink" title="执行延迟"></a>执行延迟</h3><p>Hive 在查询数据的时候，由于没有索引，需要扫描整个表，因此延迟较高。另外一个导致 Hive 执行延迟高的因素是 MapReduce 框架。由于 MapReduce 本身具有较高的延迟，因此在利用 MapReduce 执行 Hive 查询时，也会有较高的延迟。相对的，数据库的执行延迟较低。当然，这个低是有条件的，即数据规模较小，当数据规模大到超过数据库的处理能力的时候，Hive 的并行计算显然能体现出优势。</p>
<h3 id="数据规模"><a href="#数据规模" class="headerlink" title="数据规模"></a>数据规模</h3><p>由于 Hive 建立在集群上并可以利用 MapReduce 进行并行计算，因此可以支持很大规模的数据；对应的，数据库可以支持的数据规模较小。</p>
<h1 id="Hive安装"><a href="#Hive安装" class="headerlink" title="Hive安装"></a>Hive安装</h1><h2 id="Hive安装地址"><a href="#Hive安装地址" class="headerlink" title="Hive安装地址"></a>Hive安装地址</h2><ol>
<li>Hive官网地址<br><a target="_blank" rel="noopener" href="http://hive.apache.org/">http://hive.apache.org</a></li>
<li>文档查看地址<br><a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/Hive/GettingStarted">https://cwiki.apache.org/confluence/display/Hive/GettingStarted</a></li>
<li>下载地址<br><a target="_blank" rel="noopener" href="http://archive.apache.org/dist/hive/">http://archive.apache.org /dist/hive/</a></li>
<li>github地址<br><a target="_blank" rel="noopener" href="https://github.com/apache/hive">https://github.com/apache/hive</a></li>
</ol>
<h2 id="Hive安装部署"><a href="#Hive安装部署" class="headerlink" title="Hive安装部署"></a>Hive安装部署</h2><h3 id="安装Hive"><a href="#安装Hive" class="headerlink" title="安装Hive"></a>安装Hive</h3><blockquote>
<p>此hive版本由自己学习决定，路径目录同理</p>
</blockquote>
<ol>
<li>把 <code>apache-hive-3.1.2-bin.tar.gz</code> 上传到 linux 的<code>/opt/software</code>目录下</li>
<li>解压 <code>apache-hive-3.1.2-bin.tar.gz</code> 到<code>/opt/module/</code>目录下面<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf /opt/software/apache-hive-3.1.2-bin.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure></li>
<li>修改<code>apache-hive-3.1.2-bin</code>的名称为<code>hive</code><blockquote>
<p>此处可自由决定是否修改</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mv /opt/module/apache-hive-3.1.2-bin/ /opt/module/hive</span><br></pre></td></tr></table></figure></li>
<li>修改<code>/etc/profile.d/my_env.sh</code>，添加环境变量<blockquote>
<p>此处可以自己在<code>/etc/profile.d/</code>目录下创建自己的环境变量,也可以直接配置在<code>/etc/profile</code>中</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo vim /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure></li>
<li>添加文件内容<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">HIVE_HOME</span></span><br><span class="line">export HIVE_HOME=/opt/module/hive</span><br><span class="line">export PATH=$PATH:$HIVE_HOME/bin</span><br></pre></td></tr></table></figure></li>
<li>解决日志Jar冲突<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mv $HIVE_HOME/lib/log4j-slf4j-impl-2.10.0.jar $HIVE_HOME/lib/log4j-slf4j-impl-2.10.0.bak</span><br></pre></td></tr></table></figure></li>
<li>初始化元数据<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">HIVE_HOME/bin/schematool -dbType derby -initSchema</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="启动并使用Hive"><a href="#启动并使用Hive" class="headerlink" title="启动并使用Hive"></a>启动并使用Hive</h3><ol>
<li>启动Hive<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bin/hive</span><br></pre></td></tr></table></figure></li>
<li>使用Hive<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">hive&gt;</span><span class="bash"> show databases;</span> </span><br><span class="line"><span class="meta">hive&gt;</span><span class="bash"> show tables;</span></span><br><span class="line"><span class="meta">hive&gt;</span><span class="bash"> create table <span class="built_in">test</span>(id int);</span> </span><br><span class="line"><span class="meta">hive&gt;</span><span class="bash"> insert into <span class="built_in">test</span> values(1);</span> </span><br><span class="line"><span class="meta">hive&gt;</span><span class="bash"> select * from <span class="built_in">test</span>;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Hive默认使用的元数据库为<code>derby</code>,开启Hive之后就用占用源数据库,且不与其他客户端共享数据，所以我们需要将Hive的元数据地址改为<code>Mysql</code>【单窗口运行可以，多窗口时则只有一个窗口能正常运行，其他窗口报错】</p>
</blockquote>
</li>
</ol>
<h2 id="MySQL安装【如果自己已安装过MYSQL，可跳过】"><a href="#MySQL安装【如果自己已安装过MYSQL，可跳过】" class="headerlink" title="MySQL安装【如果自己已安装过MYSQL，可跳过】"></a>MySQL安装【如果自己已安装过MYSQL，可跳过】</h2><ol>
<li><p>检查当前系统是否安装过MySQL</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rpm -qa|grep mariadb</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果系统安装了Mysql，则会出现相应的mysql版本，例如<code>mariadb-libs-5.5.56-2.el7.x86_64</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">删除mysql命令</span></span><br><span class="line">sudo rpm -e --nodeps  mariadb-libs</span><br></pre></td></tr></table></figure></li>
<li><p>将 <code>MySQL</code> 安装包拷贝到<code>/opt/software</code> 目录下</p>
</li>
<li><p>解压<code>MySQL</code>安装包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">解压mysql安装包</span></span><br><span class="line">tar -xf mysql-5.7.28-1.el7.x86_64.rpm-bundle.tar</span><br></pre></td></tr></table></figure>
<p><img src="/img/Hive/mysql%E8%A7%A3%E5%8E%8B%E6%96%87%E4%BB%B6%E5%90%8E%E5%9B%BE%E7%89%87.png"></p>
</li>
<li><p>在安装目录下执行 rpm 安装</p>
<blockquote>
<p>注意：按照顺序依次执行</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo rpm -ivh mysql-community-common-5.7.28-1.el7.x86_64.rpm </span><br><span class="line">sudo rpm -ivh mysql-community-libs-5.7.28-1.el7.x86_64.rpm</span><br><span class="line">sudo rpm -ivh mysql-community-libs-compat-5.7.28-1.el7.x86_64.rpm </span><br><span class="line">sudo rpm -ivh mysql-community-client-5.7.28-1.el7.x86_64.rpm</span><br><span class="line">sudo rpm -ivh mysql-community-server-5.7.28-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure></li>
<li><p>删除<code>/etc/my.cnf </code>文件中 datadir 指向的目录下的所有内容,如果有内容的情况下:<br>查看<code>datadir</code>的值：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[mysqld] datadir=/var/lib/mysql</span><br></pre></td></tr></table></figure>
<blockquote>
<p>删除<code>/var/lib/mysql</code> 目录下的所有内容:</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 注意执行命令的位置</span></span><br><span class="line">sudo rm -rf /var/lib/mysql/*	</span><br></pre></td></tr></table></figure></li>
<li><p>初始化数据库</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo mysqld --initialize --user=mysql</span><br></pre></td></tr></table></figure></li>
<li><p>查看临时生成的<code>root</code>用户的密码</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo cat /var/log/mysqld.log</span><br></pre></td></tr></table></figure>
<p><img src="/img/Hive/mysql%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AF%86%E7%A0%81.png"></p>
</li>
<li><p>启动Mysql服务</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo systemctl start mysqld</span><br></pre></td></tr></table></figure></li>
<li><p>登录 MySQL 数据库</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p</span><br><span class="line">Enter password:	输入临时生成的密码</span><br></pre></td></tr></table></figure></li>
<li><p>必须先修改root用户密码，否则执行其他的操作会报错</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql &gt; set password = password(&quot;新密码&quot;); </span><br></pre></td></tr></table></figure></li>
<li><p>修改 mysql 库下的 user 表中的 root 用户允许任意 ip 连接</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; update mysql.user set host=&#x27;%&#x27; where user=&#x27;root&#x27;; </span><br><span class="line">mysql&gt; flush privileges;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Hive-元数据配置到-MySQL"><a href="#Hive-元数据配置到-MySQL" class="headerlink" title="Hive 元数据配置到 MySQL"></a>Hive 元数据配置到 MySQL</h2><h3 id="拷贝驱动"><a href="#拷贝驱动" class="headerlink" title="拷贝驱动"></a>拷贝驱动</h3><p>将 MySQL 的 JDBC 驱动拷贝到 Hive 的 lib 目录下</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp /opt/software/mysql-connector-java-5.1.37.jar $HIVE_HOME/lib</span><br></pre></td></tr></table></figure>
<h3 id="配置-Metastore-到-MySQL"><a href="#配置-Metastore-到-MySQL" class="headerlink" title="配置 Metastore 到 MySQL"></a>配置 Metastore 到 MySQL</h3><ol>
<li><p>在<code>$HIVE_HOME/conf</code> 目录下新建 <code>hive-site.xml</code> 文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim $HIVE_HOME/conf/hive-site.xml</span><br></pre></td></tr></table></figure>
<blockquote>
<p>添加如下内容</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- jdbc 连接的 URL --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://hadoop102:3306/metastore?useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- jdbc 连接的 Driver--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- jdbc 连接的 username--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- jdbc 连接的 password --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>000000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Hive 元数据存储版本的验证 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.schema.verification<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--元数据存储授权--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.event.db.notification.api.auth<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Hive 默认在 HDFS 的工作目录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>登录MySQL</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p自定义密码</span><br></pre></td></tr></table></figure></li>
<li><p>新建Hive元数据</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> create database metastore;</span> </span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> quit;</span></span><br></pre></td></tr></table></figure></li>
<li><p>初始化Hive元数据库</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">schematool -initSchema -dbType mysql - verbose</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="再次启动Hive"><a href="#再次启动Hive" class="headerlink" title="再次启动Hive"></a>再次启动Hive</h3><ol>
<li>启动Hive<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bin/hive</span><br></pre></td></tr></table></figure></li>
<li>使用hive<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hive&gt; show databases; </span><br><span class="line">hive&gt; show tables;</span><br><span class="line">hive&gt; create table test (id int); </span><br><span class="line">hive&gt; insert into test values(1); </span><br><span class="line">hive&gt; select * from test;</span><br></pre></td></tr></table></figure></li>
<li>启动另外一个窗口开启Hive<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">hive&gt;</span><span class="bash"> show databases;</span> </span><br><span class="line"><span class="meta">hive&gt;</span><span class="bash"> show tables;</span> </span><br><span class="line"><span class="meta">hive&gt;</span><span class="bash"> select * from aa;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="使用元数据服务的方式访问-Hive"><a href="#使用元数据服务的方式访问-Hive" class="headerlink" title="使用元数据服务的方式访问 Hive"></a>使用元数据服务的方式访问 Hive</h2><blockquote>
<p>由于上方的配置只能服务器访问，此处操作用作外部访问，例如代码访问hive数据源</p>
</blockquote>
<ol>
<li>在 <code>hive-site.xml</code> 文件中添加如下配置信息<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定存储元数据要连接的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.uris<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>thrift://hadoop102:9083<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>启动metastore<blockquote>
<p>前台运行</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hive --service metastore </span><br><span class="line">2020-04-24 16:58:08: Starting Hive Metastore Server </span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意: 启动后窗口不能再操作，需打开一个新的 shell 窗口做别的操作</span></span><br></pre></td></tr></table></figure></li>
<li>启动hive<blockquote>
<p>运行服务器客户端查看</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bin/hive</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="使用JDBC方式访问Hive"><a href="#使用JDBC方式访问Hive" class="headerlink" title="使用JDBC方式访问Hive"></a>使用JDBC方式访问Hive</h2><ol>
<li>在 <code>hive-site.xml</code> 文件中添加如下配置信息<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定 hiveserver2 连接的 host --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.bind.host<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指定 hiveserver2 连接的端口号 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>启动hiveserver2<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bin/hive --service hiveserver2</span><br></pre></td></tr></table></figure></li>
<li>启动beeline客户端(需要多等待一会)<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bin/beeline -u jdbc:hive2://hadoop102:10000 -n atguigu</span><br></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 参数</span><br><span class="line">The Beeline CLI 支持以下命令行参数:    </span><br><span class="line">Option    </span><br><span class="line">Description    </span><br><span class="line">--autoCommit=[true/false] ---进入一个自动提交模式：beeline --autoCommit=true    </span><br><span class="line">--autosave=[true/false]   ---进入一个自动保存模式：beeline --autosave=true    </span><br><span class="line">--color=[true/false]    ---显示用到的颜色：beeline --color=true    </span><br><span class="line">--delimiterForDSV= DELIMITER ---分隔值输出格式的分隔符。默认是“|”字符。    </span><br><span class="line">--fastConnect=[true/false]  ---在连接时，跳过组建表等对象：beeline --fastConnect=false    </span><br><span class="line">--force=[true/false]    ---是否强制运行脚本：beeline--force=true    </span><br><span class="line">--headerInterval=ROWS   ---输出的表间隔格式，默认是100: beeline --headerInterval=50    </span><br><span class="line">--help ---帮助  beeline --help    </span><br><span class="line">--hiveconf property=value  ---设置属性值，以防被hive.conf.restricted.list重置：beeline --hiveconf prop1=value1     </span><br><span class="line">--hivevar name=value   ---设置变量名：beeline --hivevar var1=value1    </span><br><span class="line">--incremental=[true/false]  ---输出增量  </span><br><span class="line">--isolation=LEVEL  ---设置事务隔离级别：beeline --isolation=TRANSACTION_SERIALIZABLE    </span><br><span class="line">--maxColumnWidth=MAXCOLWIDTH ---设置字符串列的最大宽度：beeline --maxColumnWidth=25    </span><br><span class="line">--maxWidth=MAXWIDTH ---设置截断数据的最大宽度：beeline --maxWidth=150    </span><br><span class="line">--nullemptystring=[true/false]  ---打印空字符串：beeline --nullemptystring=false    </span><br><span class="line">--numberFormat=[pattern]     ---数字使用DecimalFormat：beeline --numberFormat=&quot;#,###,##0.00&quot;    </span><br><span class="line">--outputformat=[table/vertical/csv/tsv/dsv/csv2/tsv2] ---输出格式：beeline --outputformat=tsv     </span><br><span class="line">--showHeader=[true/false]   ---显示查询结果的列名：beeline --showHeader=false    </span><br><span class="line">--showNestedErrs=[true/false] ---显示嵌套错误：beeline --showNestedErrs=true    </span><br><span class="line">--showWarnings=[true/false] ---显示警告：beeline --showWarnings=true    </span><br><span class="line">--silent=[true/false]  ---减少显示的信息量：beeline --silent=true    </span><br><span class="line">--truncateTable=[true/false] ---是否在客户端截断表的列       </span><br><span class="line">--verbose=[true/false]  ---显示详细错误信息和调试信息：beeline --verbose=true    </span><br><span class="line">-d &lt;driver class&gt;  ---使用一个驱动类：beeline -d driver_class    </span><br><span class="line">-e &lt;query&gt;  ---使用一个查询语句：beeline -e &quot;query_string&quot;    </span><br><span class="line">-f &lt;file&gt;  ---加载一个文件：beeline -f filepath  多个文件用-e file1 -e file2  </span><br><span class="line">-n &lt;username&gt;  ---加载一个用户名：beeline -n valid_user    </span><br><span class="line">-p &lt;password&gt;  ---加载一个密码：beeline -p valid_password    </span><br><span class="line">-u &lt;database URL&gt; ---加载一个JDBC连接字符串：beeline -u db_URL   &lt;/span&gt;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><p>登录成功界面</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Connecting to jdbc:hive2://hadoop102:10000 </span><br><span class="line">Connected to: Apache Hive (version 3.1.2) </span><br><span class="line">Driver: Hive JDBC (version 3.1.2)</span><br><span class="line">Transaction isolation: TRANSACTION_REPEATABLE_READ </span><br><span class="line">Beeline version 3.1.2 by Apache Hive</span><br><span class="line">0: jdbc:hive2://hadoop102:10000&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>编写hive服务启动脚本(了解)</p>
<blockquote>
<p>前台启动的方式导致需要打开多个 shell 窗口，可以使用如下方式后台方式启动<br><code>nohup</code>:  放在命令开头，表示不挂起,也就是关闭终端进程也继续保持运行状态<br><code>/dev/null</code>：是 Linux 文件系统中的一个文件，被称为黑洞，所有写入改文件的内容 都会被自动丢弃<br><code>2&gt;&amp;1</code> :  表示将错误重定向到标准输出上<br><code>&amp;</code>:  放在命令结尾,表示后台运行<br>一般会组合使用: <code>nohup [xxx 命令操作]&gt; file 2&gt;&amp;1 &amp;</code>，表示将 xxx 命令运行的结 果输出到 file 中，并保持命令启动的进程在后台运行。</p>
</blockquote>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop202 hive]$ nohup hive --service metastore 2&gt;&amp;1 &amp; </span><br><span class="line">[root@hadoop202 hive]$ nohup hive --service hiveserver2 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<p>(1) 编写hiverserver脚本</p>
<blockquote>
<p>为了方便使用，可以直接编写脚本来管理服务的启动和关闭</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim $HIVE_HOME/bin/hiveservices.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">!/bin/bash </span><br><span class="line">HIVE_LOG_DIR=<span class="variable">$HIVE_HOME</span>/logs</span><br><span class="line"><span class="comment"># -d 判断当前路径是否存在，并且是否是文件夹</span></span><br><span class="line"><span class="keyword">if</span> [ ! -d <span class="variable">$HIVE_LOG_DIR</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">        mkdir -p <span class="variable">$HIVE_LOG_DIR</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment">#检查进程是否运行正常，参数 1 为进程名，参数 2 为进程端口</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">check_process</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">#grep -v grep 表示查询内容不包含grep[-v 则表示不包含，-i就是包含(默认)]</span></span><br><span class="line">        <span class="comment">#awk 分割</span></span><br><span class="line">        <span class="comment">#&#123;print $2&#125; 取分割后的第二位结果</span></span><br><span class="line">        pid=$(ps -ef 2&gt;/dev/null | grep -v grep | grep -i <span class="variable">$1</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line">        <span class="comment">#netstat -nltp |grep 端口号 |awk &#x27;print&#123;print $7&#125;&#x27; 通过端口号查进程号</span></span><br><span class="line">        <span class="comment">#cut -d &#x27;/&#x27; -f 1 通过&#x27;/&#x27;分割 取第一位</span></span><br><span class="line">        ppid=$(netstat -nltp 2&gt;/dev/null | grep <span class="variable">$2</span> | awk <span class="string">&#x27;&#123;print $7&#125;&#x27;</span> | cut -d <span class="string">&#x27;/&#x27;</span> -f 1)</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$pid</span></span><br><span class="line">        [[ <span class="string">&quot;<span class="variable">$pid</span>&quot;</span> =~ <span class="string">&quot;<span class="variable">$ppid</span>&quot;</span> ]] &amp;&amp; [ <span class="string">&quot;<span class="variable">$ppid</span>&quot;</span> ] &amp;&amp; <span class="built_in">return</span> 0 || <span class="built_in">return</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">hive_start</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">        metapid=$(check_process HiveMetastore 9083)</span><br><span class="line">        cmd=<span class="string">&quot;nohup hive --service metastore &gt;<span class="variable">$HIVE_LOG_DIR</span>/metastore.log 2&gt;&amp;1&amp;&quot;</span></span><br><span class="line">        <span class="comment">#如果metapid返回值为0，就走cmd指令，反之返回值为1，控制台输出提示   -z判断字符串是否为0</span></span><br><span class="line">        <span class="comment">#eval等于语句解析完再执行，sh只解析一层</span></span><br><span class="line">        [ -z <span class="string">&quot;<span class="variable">$metapid</span>&quot;</span> ] &amp;&amp; <span class="built_in">eval</span> <span class="variable">$cmd</span> || <span class="built_in">echo</span> <span class="string">&quot;Metastroe 服务已启动&quot;</span> </span><br><span class="line">        server2pid=$(check_process HiveServer2 10000)</span><br><span class="line">        cmd=<span class="string">&quot;nohup hive --service hiveserver2 &gt;<span class="variable">$HIVE_LOG_DIR</span>/hiveServer2.log 2&gt;&amp;1 &amp;&quot;</span></span><br><span class="line">        [ -z <span class="string">&quot;<span class="variable">$server2pid</span>&quot;</span> ] &amp;&amp; <span class="built_in">eval</span> <span class="variable">$cmd</span> || <span class="built_in">echo</span> <span class="string">&quot;HiveServer2 服务已启动&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">hive_stop</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">        metapid=$(check_process HiveMetastore 9083)</span><br><span class="line">        [ <span class="string">&quot;<span class="variable">$metapid</span>&quot;</span> ] &amp;&amp; <span class="built_in">kill</span> <span class="variable">$metapid</span> || <span class="built_in">echo</span> <span class="string">&quot;Metastore 服务未启动&quot;</span></span><br><span class="line">         server2pid=$(check_process HiveServer2 10000)</span><br><span class="line">        [ <span class="string">&quot;<span class="variable">$server2pid</span>&quot;</span> ] &amp;&amp; <span class="built_in">kill</span> <span class="variable">$server2pid</span> || <span class="built_in">echo</span> <span class="string">&quot;HiveServer2 服务未启动&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line"><span class="string">&quot;start&quot;</span>)</span><br><span class="line">        hive_start</span><br><span class="line">        ;;</span><br><span class="line"><span class="string">&quot;stop&quot;</span>)</span><br><span class="line">        hive_stop</span><br><span class="line">        ;;</span><br><span class="line"><span class="string">&quot;restart&quot;</span>)</span><br><span class="line">        hive_stop sleep 2 hive_start</span><br><span class="line">        ;;</span><br><span class="line"><span class="string">&quot;status&quot;</span>)</span><br><span class="line">        check_process HiveMetastore 9083 &gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;Metastore 服务运行 正常&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;Metastore 服务运行 异常&quot;</span></span><br><span class="line">        check_process HiveServer2 10000 &gt;/dev/null &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;HiveServer2 服务运行 正常&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;HiveServer2 服务运行 异常&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">*)</span><br><span class="line">        <span class="built_in">echo</span> Invalid Args!</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&#x27;Usage: &#x27;</span>$(basename <span class="variable">$0</span>)<span class="string">&#x27; start|stop|restart|status&#x27;</span></span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<p>(2) 添加执行权限</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 hive]$ chmod +x $HIVE_HOME/bin/hiveservices.sh</span><br></pre></td></tr></table></figure>
<p>(3) 启动Hive后台服务</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 hive]$ hiveservices.sh start 	</span><br></pre></td></tr></table></figure>
<blockquote>
<p>也可以简单启动</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop202 hive]$ nohup hive --service metastore 2&gt;&amp;1 &amp; </span><br><span class="line">[root@hadoop202 hive]$ nohup hive --service hiveserver2 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<h2 id="Hive常用交互命令"><a href="#Hive常用交互命令" class="headerlink" title="Hive常用交互命令"></a>Hive常用交互命令</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 hive]$ bin/hive -help usage: hive</span><br><span class="line">-d,--define &lt;key=value&gt;	Variable subsitution to apply to hive</span><br><span class="line">commands. e.g. -d A=B or --define A=B</span><br><span class="line">--database &lt;databasename&gt;	Specify the database to use</span><br><span class="line">-e &lt;quoted-query-string&gt;	SQL from command line</span><br><span class="line">-f &lt;filename&gt;	SQL from files</span><br><span class="line">-H,--help	Print help information</span><br><span class="line">--hiveconf &lt;property=value&gt;	Use value for given property</span><br><span class="line">--hivevar &lt;key=value&gt;	Variable subsitution to apply to hive</span><br><span class="line">commands. e.g. --hivevar A=B</span><br><span class="line">-i &lt;filename&gt;	Initialization SQL file</span><br><span class="line">-S,--silent	Silent mode in interactive shell</span><br><span class="line">-v,--verbose	Verbose mode (echo executed SQL to the console)</span><br></pre></td></tr></table></figure>
<ol>
<li><code>-e</code>不进入 hive 的交互窗口执行 sql 语句<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 hive]$ bin/hive -e &quot;select id from student;&quot; 	</span><br></pre></td></tr></table></figure></li>
<li><code>-f</code>执行脚本中 sql 语句<br>（1）在<code>/opt/module/hive/</code>下创建 datas 目录并在 datas 目录下创建 <code>hivef.sql</code> 文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 datas]$ touch hivef.sql </span><br></pre></td></tr></table></figure>
（2）文件中写入正确的 sql 语句<br><code>select *from student;</code><br>（3）执行文件中的 sql 语句<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 hive]$ bin/hive -f /opt/module/hive/datas/hivef.sql 	</span><br></pre></td></tr></table></figure>
（4）执行文件中的 sql 语句并将结果写入文件中<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 hive]$ bin/hive -f /opt/module/hive/datas/hivef.sql  &gt; /opt/module/datas/hive_result.txt</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Hive其他命令操作"><a href="#Hive其他命令操作" class="headerlink" title="Hive其他命令操作"></a>Hive其他命令操作</h2><ol>
<li>退出 hive 窗口：<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hive(default)&gt;exit; </span><br><span class="line">hive(default)&gt;quit;</span><br></pre></td></tr></table></figure></li>
<li>在 hive cli 命令窗口中如何查看 hdfs 文件系统<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hive(default)&gt;dfs -ls /;</span><br></pre></td></tr></table></figure></li>
<li>查看在 hive 中输入的所有历史命令<br>（1）进入到当前用户的根目录 /root 或/home/atguigu<br>（2）查看. hivehistory 文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop102 ~]$ cat .hivehistory </span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Hive-常见属性配置"><a href="#Hive-常见属性配置" class="headerlink" title="Hive 常见属性配置"></a>Hive 常见属性配置</h2><h3 id="Hive-运行日志信息配置"><a href="#Hive-运行日志信息配置" class="headerlink" title="Hive 运行日志信息配置"></a>Hive 运行日志信息配置</h3><ol>
<li>Hive 的 log 默认存放在<code>/tmp/root/hive.log</code> 目录下（当前用户名下）<br>（1）修改<code>/opt/module/hive/conf/hive-log4j2.properties.template</code>  文件名称为 <code>hive-log4j2.properties</code><br>（2）在 <code>hive-log4j2.properties</code> 文件中修改 log 存放位置<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="meta">hive.log.dir</span>=<span class="string">/opt/module/hive/logs </span></span><br></pre></td></tr></table></figure>
<h3 id="打印-当前库-和-表头"><a href="#打印-当前库-和-表头" class="headerlink" title="打印 当前库 和 表头"></a>打印 当前库 和 表头</h3>在 hive-site.xml 中加入如下两个配置:<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.header<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.current.db<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="参数配置方式"><a href="#参数配置方式" class="headerlink" title="参数配置方式"></a>参数配置方式</h3><ol>
<li>查看当前所有的配置信息<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hive&gt;set; </span><br></pre></td></tr></table></figure></li>
<li>参数的配置三种方式</li>
</ol>
<ul>
<li><p>(1)配置文件方式 默认配置文件：<code>hive-default.xml</code> 用户自定义配置文件：<code>hive-site.xml</code></p>
<blockquote>
<p>注意：用户自定义配置会覆盖默认配置。另外，<code>Hive</code> 也会读入 <code>Hadoop</code> 的配置，因为 <code>Hive</code> 是作为 <code>Hadoop</code> 的客户端启动的，<code>Hive</code> 的配置会覆盖 <code>Hadoop</code> 的配置。配置文件的设定对本 机启动的所有 <code>Hive</code> 进程都有效。</p>
</blockquote>
</li>
<li><p>(2)命令行参数方式<br>启动 <code>Hive</code> 时，可以在命令行添加<code>-hiveconf param=value</code> 来设定参数。<br>例如：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@hadoop103 hive]$ bin/hive -hiveconf mapred.reduce.tasks=10; 	</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>注意：仅对本次hive启动有效</strong> 查看参数设置：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hive (default)&gt; set mapred.reduce.tasks; 	</span><br></pre></td></tr></table></figure>

<ul>
<li>(3)参数声明方式<br>可以在 HQL 中使用 SET 关键字设定参数<br>例如：<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hive (default)&gt; set mapred.reduce.tasks=100; </span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>注意：仅对本次 hive 启动有效。</strong> 查看参数设置</p>
<pre><code>hive (default)&gt; set mapred.reduce.tasks;
</code></pre>
<blockquote>
<p>上述三种设定方式的优先级依次递增。即<code>配置文件&lt;命令行参数&lt;参数声明</code>。<strong>注意某些系统级的参数，例如 <code>log4j</code> 相关的设定，必须用前两种方式设定，因为那些参数的读取在会话建立以前已经完成了。</strong></p>
</blockquote>
<h1 id="Hive-数据类型"><a href="#Hive-数据类型" class="headerlink" title="Hive 数据类型"></a>Hive 数据类型</h1><h2 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h2><p><img src="/img/Hive/Hive%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.png"><br>对于 Hive 的 String 类型相当于数据库的 varchar 类型，该类型是一个可变的字符串，不 过它不能声明其中最多能存储多少个字符，理论上它可以存储 2GB 的字符数。</p>
<h2 id="集合数据类型"><a href="#集合数据类型" class="headerlink" title="集合数据类型"></a>集合数据类型</h2><p><img src="/img/Hive/%E9%9B%86%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.png"><br>Hive 有三种复杂数据类型 <code>ARRAY</code>、<code>MAP</code> 和 <code>STRUCT</code>。ARRAY 和 MAP 与 Java 中的 Array 和 Map 类似，而 STRUCT 与 C 语言中的 Struct 类似，它封装了一个命名字段集合，复杂数据 类型允许任意层次的嵌套。</p>
<ol>
<li>案例实操<br>（1）假设某表有如下一行，我们用 JSON 格式来表示其数据结构。在 Hive 下访问的格式为<br><img src="/img/Hive/%E9%9B%86%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AE%9E%E4%BE%8B.png"></li>
</ol>
<p>（2）基于上述数据结构，我们在 Hive 里创建对应的表，并导入数据。 创建本地测试文件 test.txt<br><img src="/img/Hive/test.png"><br>注意：MAP，STRUCT 和 ARRAY 里的元素间关系都可以用同一个字符表示，这里用“_”。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:541039648@qq.com">Kirito</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dgut-zzf.github.io/2022/06/07/%E5%A4%A7%E6%95%B0%E6%8D%AE-Hive3/">https://dgut-zzf.github.io/2022/06/07/%E5%A4%A7%E6%95%B0%E6%8D%AE-Hive3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://dgut-zzf.github.io" target="_blank">傻瓜の博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hive/">Hive</a></div><div class="post_share"><div class="social-share" data-image="/img/avatar/%E8%9D%B6%E7%A5%882.gif" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/06/27/Hadoop3-X%E3%80%90HDFS%E3%80%91/"><img class="prev-cover" src="https://dgut-zzf.github.io/img/background/0e2442a7d933c8955b3ef3d7d31373f0830200dd.gif" onerror="onerror=null;src='/img/background/0e2442a7d933c8955b3ef3d7d31373f0830200dd.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hadoop3.X【HDFS】</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/28/redis%E7%9A%84%E5%AD%A6%E4%B9%A0/"><img class="next-cover" src="https://dgut-zzf.github.io/img/background/0e2442a7d933c8955b3ef3d7d31373f0830200dd.gif" onerror="onerror=null;src='/img/background/0e2442a7d933c8955b3ef3d7d31373f0830200dd.gif'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">redis的学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/11/23/Hive数据上传/" title="Hive数据上传"><img class="cover" src="https://dgut-zzf.github.io/img/background/0e2442a7d933c8955b3ef3d7d31373f0830200dd.gif" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-23</div><div class="title">Hive数据上传</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC-1-%E7%AB%A0-Hive-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">第 1 章 Hive 基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Hive"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 Hive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">Hive 的优缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">Hive 架构原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E6%AF%94%E8%BE%83"><span class="toc-number">1.4.</span> <span class="toc-text">Hive 和数据库比较</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-number">1.4.1.</span> <span class="toc-text">查询语言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0"><span class="toc-number">1.4.2.</span> <span class="toc-text">数据更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E5%BB%B6%E8%BF%9F"><span class="toc-number">1.4.3.</span> <span class="toc-text">执行延迟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%A7%84%E6%A8%A1"><span class="toc-number">1.4.4.</span> <span class="toc-text">数据规模</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hive%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">Hive安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive%E5%AE%89%E8%A3%85%E5%9C%B0%E5%9D%80"><span class="toc-number">2.1.</span> <span class="toc-text">Hive安装地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2"><span class="toc-number">2.2.</span> <span class="toc-text">Hive安装部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Hive"><span class="toc-number">2.2.1.</span> <span class="toc-text">安装Hive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%B9%B6%E4%BD%BF%E7%94%A8Hive"><span class="toc-number">2.2.2.</span> <span class="toc-text">启动并使用Hive</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E5%AE%89%E8%A3%85%E3%80%90%E5%A6%82%E6%9E%9C%E8%87%AA%E5%B7%B1%E5%B7%B2%E5%AE%89%E8%A3%85%E8%BF%87MYSQL%EF%BC%8C%E5%8F%AF%E8%B7%B3%E8%BF%87%E3%80%91"><span class="toc-number">2.3.</span> <span class="toc-text">MySQL安装【如果自己已安装过MYSQL，可跳过】</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E5%85%83%E6%95%B0%E6%8D%AE%E9%85%8D%E7%BD%AE%E5%88%B0-MySQL"><span class="toc-number">2.4.</span> <span class="toc-text">Hive 元数据配置到 MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%B7%E8%B4%9D%E9%A9%B1%E5%8A%A8"><span class="toc-number">2.4.1.</span> <span class="toc-text">拷贝驱动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-Metastore-%E5%88%B0-MySQL"><span class="toc-number">2.4.2.</span> <span class="toc-text">配置 Metastore 到 MySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%8D%E6%AC%A1%E5%90%AF%E5%8A%A8Hive"><span class="toc-number">2.4.3.</span> <span class="toc-text">再次启动Hive</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%85%83%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%96%B9%E5%BC%8F%E8%AE%BF%E9%97%AE-Hive"><span class="toc-number">2.5.</span> <span class="toc-text">使用元数据服务的方式访问 Hive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8JDBC%E6%96%B9%E5%BC%8F%E8%AE%BF%E9%97%AEHive"><span class="toc-number">2.6.</span> <span class="toc-text">使用JDBC方式访问Hive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive%E5%B8%B8%E7%94%A8%E4%BA%A4%E4%BA%92%E5%91%BD%E4%BB%A4"><span class="toc-number">2.7.</span> <span class="toc-text">Hive常用交互命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4%E6%93%8D%E4%BD%9C"><span class="toc-number">2.8.</span> <span class="toc-text">Hive其他命令操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hive-%E5%B8%B8%E8%A7%81%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="toc-number">2.9.</span> <span class="toc-text">Hive 常见属性配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hive-%E8%BF%90%E8%A1%8C%E6%97%A5%E5%BF%97%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE"><span class="toc-number">2.9.1.</span> <span class="toc-text">Hive 运行日志信息配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8D%B0-%E5%BD%93%E5%89%8D%E5%BA%93-%E5%92%8C-%E8%A1%A8%E5%A4%B4"><span class="toc-number">2.9.2.</span> <span class="toc-text">打印 当前库 和 表头</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="toc-number">2.9.3.</span> <span class="toc-text">参数配置方式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hive-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.</span> <span class="toc-text">Hive 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.1.</span> <span class="toc-text">基本数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.2.</span> <span class="toc-text">集合数据类型</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Kirito</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://dgut-zzf.github.io/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '2c4096047dcd6a9afc51',
      clientSecret: 'fdb7e0ab87224c10429e215faee82c6ed9a0b9b3',
      repo: 'dgut-zzf.github.io',
      owner: 'dgut-zzf',
      admin: ['dgut-zzf'],
      id: '25a82cd6f0189cec199ade016a9bd5d4',
      language: 'en',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><div class="aplayer no-destroy" data-id="7530393082" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>((window.gitter = {}).chat = {}).options = {
  disableDefaultChat: true,
};
document.addEventListener('gitter-sidecar-ready', (e) => {
  const GitterChat = e.detail.Chat
  let chat

  function initGitter () {
    chat = new GitterChat({
      room: 'zzf-blog/community',
      activationElement: '#chat_btn'
    });
  }

  initGitter()

  if (true) {
    document.addEventListener('pjax:complete', () => {
      chat.destroy()
      initGitter()
    })
  }

})</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="async" defer="defer"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.removeEventListener('scroll', window.tocScrollFn)
  window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-2MDKV7YRZQ', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":145,"height":315},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body></html>